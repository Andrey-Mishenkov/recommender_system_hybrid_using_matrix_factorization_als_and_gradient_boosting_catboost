# Проект: Рекомендательная система книг на основе гибридного метода (ALS + CatBoost)

## Описание проекта

---

### Цель проекта
- Разработать рекомендательную систему книг, сочетающую коллаборативную фильтрацию (ALS) и контентные признаки (CatBoost).
- Основная задача — повысить качество рекомендаций за счет комбинации двух подходов: матричной факторизации и классификации на основе признаков книг и пользователей.
- Проверить гипотезу о том, что гибридный метод превзойдет базовую модель ALS по метрике mAP@10.

---

### Этапы выполнения проекта

1. **Подготовка данных и создание user-item-матрицы**
   - Загрузка данных: книги (`books.csv`), рейтинги (`ratings.csv`), жанры (`goodreads_book_genres_initial.json`)
   - Бинаризация рейтингов (оценка ≥ 4 → 1, иначе → 0)
   - Разбиение данных на train/test (70/30) на основе порядка прочтения
   - Построение user-item-матрицы размера `53 424 × 10 000`

2. **Применение метода матричной факторизации и создание бейзлайна**
   - Реализация функции `ap_at_k()` для расчета Average Precision at K
   - Обучение базовой модели ALS (`factors=50`, `iterations=15`)
   - Расчет **mAP@10 для ALS (базовый): 0,047412**

3. **Сбор контентных признаков и обучение классификатора**
   - Извлечение признаков пользователей (статистика оценок, жанровые предпочтения)
   - Извлечение признаков книг (средний рейтинг, количество оценок, жанры)
   - One-hot кодирование жанров книг
   - Обучение и калибровка CatBoostClassifier с учетом дисбаланса классов

4. **Реализация гибридного метода и оценка качества**
   - Получение рекомендаций от ALS (до 30 книг на пользователя)
   - Ранжирование кандидатов с помощью CatBoost
   - Объединение оценок ALS и CatBoost с оптимальным весом
   - Расчет **mAP@10 для гибридной модели: 0,050410**

5. **Сравнение моделей и оптимизация весов**
   - Поиск оптимального веса между ALS и CatBoost (от 0 до 1)
   - Визуализация результатов по качеству и скорости работы

---

### Результаты моделей (метрика mAP@10)

- **Модель ALS (базовые параметры): `0.047412`**
- **Гибридная модель (ALS + CatBoost): `0.050410`**

#### Улучшение гибридной модели относительно базового ALS:
- Абсолютное: **+0,003 п.п.**
- Относительное: **+6,3%**

---

### Основные наблюдения и выводы

1. **Эффективность гибридного подхода**:
   - Комбинация ALS и CatBoost улучшила качество рекомендаций на 6,3%.
   - Гибридный метод лучше учитывает как коллаборативные взаимодействия, так и контентные характеристики.
   - Обеспечивает более персонализированные и релевантные рекомендации.

2. **Влияние весового коэффициента**:
   - Наилучший результат достигнут при равном весе ALS и CatBoost (`weight_coef = 0.5`).
   - Увеличение доли CatBoost сверх 0,5 снижает качество, что указывает на важность коллаборативной составляющей.

3. **Производительность моделей**:
   - ALS работает значительно быстрее (0,5 сек) за счёт матричной факторизации.
   - Гибридный метод требует больше времени (8,7 сек) из-за генерации признаков и предсказаний CatBoost.

### Итог
- Разработана гибридная рекомендательная система, сочетающая матричную факторизацию (ALS) и классификацию на основе признаков (CatBoost).
- Гибридная модель превзошла базовый ALS по метрике mAP@10 на 6,3%, подтвердив эффективность комбинированного подхода.
- Проект продемонстрировал, что объединение коллаборативных и контентных методов позволяет улучшить качество персонализации в рекомендательных системах.